# Importing the dataset #
eco<-read.table("ecomorphological data.txt",header=T,row.names=1)
# Generating the PCoA #
pcoa<-cmdscale(daisy(eco,metric="gower"),k=ncol(eco)-1,eig=TRUE,add=TRUE)
# Opening libraries #
library(cluster)
# Importing the dataset #
eco<-read.table("ecomorphological data.txt",header=T,row.names=1)
# Generating the PCoA #
pcoa<-cmdscale(daisy(eco,metric="gower"),k=ncol(eco)-1,eig=TRUE,add=TRUE)
# Calculating the
eigenvals(pcoa)/sum(eigenvals(pcoa))
libary(vegan)
library(vegan)
# Calculating the #
eigenvals(pcoa)/sum(eigenvals(pcoa))
# Calculating the #
(eigenvals(pcoa)/sum(eigenvals(pcoa)))*100
# Fitting ecomorphological indices to ordination #
efit<-envfit(pcoa,eco2, permutations = 999, na.rm = TRUE,choices=c(1:3))
efit2<-as.data.frame(efit$vectors$arrows*sqrt(efit$vectors$r))
library(vegan)
# Fitting ecomorphological indices to ordination #
efit<-envfit(pcoa,eco2, permutations = 999, na.rm = TRUE,choices=c(1:3))
# Fitting ecomorphological indices to ordination #
efit<-envfit(pcoa,eco, permutations = 999, na.rm = TRUE,choices=c(1:3))
efit2<-as.data.frame(efit$vectors$arrows*sqrt(efit$vectors$r))
efit2<-rbind(efit2,efit$factors$centroids*sqrt(efit$factors$r))
efit
# Plotting Supplementary Figure 1 #
ggplot()+
geom_text(mapping=aes(x=scores[,1],y=scores[,2],label=rownames(scores)),size=5)+
xlab("PC1 (33.21%)")+xlim(c(min(scores[,1])-0.08,max(scores[,1])+0.08))+
ylab("PC2 (26.87%)")+ylim(c(min(scores[,2])-0.08,max(scores[,2])+0.08))+
geom_segment(data=efit2,aes(x=0,xend=efit2[,1]/2.5,y=0,yend=efit2[,2]/2.5),
arrow = arrow(length = unit(0.5, "cm")),colour="blue",
size=0.8,alpha=0.2,inherit.aes=FALSE)+
geom_text(data=efit2,aes(x=(efit2[,1]/2.5),y=(efit2[,2]/2.5+0.015),label=row.names(efit2)),
size=4,color="blue",fontface="bold",alpha=0.5)+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 14),
axis.title = element_text(colour = "black", size = 16, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 12))
library(ggplot2)
# Plotting Supplementary Figure 1 #
ggplot()+
geom_text(mapping=aes(x=scores[,1],y=scores[,2],label=rownames(scores)),size=5)+
xlab("PC1 (33.21%)")+xlim(c(min(scores[,1])-0.08,max(scores[,1])+0.08))+
ylab("PC2 (26.87%)")+ylim(c(min(scores[,2])-0.08,max(scores[,2])+0.08))+
geom_segment(data=efit2,aes(x=0,xend=efit2[,1]/2.5,y=0,yend=efit2[,2]/2.5),
arrow = arrow(length = unit(0.5, "cm")),colour="blue",
size=0.8,alpha=0.2,inherit.aes=FALSE)+
geom_text(data=efit2,aes(x=(efit2[,1]/2.5),y=(efit2[,2]/2.5+0.015),label=row.names(efit2)),
size=4,color="blue",fontface="bold",alpha=0.5)+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 14),
axis.title = element_text(colour = "black", size = 16, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 12))
# Plotting Supplementary Figure 1 #
ggplot()+
geom_text(mapping=aes(x=scores[,1],y=scores[,2],label=rownames(scores)),size=5)+
xlab("PC1 (33.21%)")+xlim(c(min(scores[,1])-0.08,max(scores[,1])+0.08))+
ylab("PC2 (26.87%)")+ylim(c(min(scores[,2])-0.08,max(scores[,2])+0.08))+
geom_segment(data=efit2,aes(x=0,xend=efit2[,1]/2.5,y=0,yend=efit2[,2]/2.5),
arrow = arrow(length = unit(0.5, "cm")),colour="blue",
size=0.8,alpha=0.2,inherit.aes=FALSE)+
geom_text(data=efit2,aes(x=(efit2[,1]/2.5),y=(efit2[,2]/2.5+0.015),label=row.names(efit2)),
size=4,color="blue",fontface="bold",alpha=0.5)+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 14),
axis.title = element_text(colour = "black", size = 16, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 12))
# Plotting Supplementary Figure 1 #
ggplot()+
geom_text(mapping=aes(x=scores[,1],y=scores[,2],label=rownames(scores)),size=5)+
xlab("PC1 (33.21%)")+xlim(c(min(scores[,1])-0.08,max(scores[,1])+0.08))+
ylab("PC2 (26.87%)")+ylim(c(min(scores[,2])-0.08,max(scores[,2])+0.08))+
geom_segment(data=efit2,aes(x=0,xend=efit2[,1]/2.5,y=0,yend=efit2[,2]/2.5),
arrow = arrow(length = unit(0.5, "cm")),colour="blue",
size=0.8,alpha=0.2,inherit.aes=FALSE)+
geom_text(data=efit2,aes(x=(efit2[,1]/2.5),y=(efit2[,2]/2.5+0.015),label=row.names(efit2)),
size=4,color="blue",fontface="bold",alpha=0.5)
# Plotting Supplementary Figure 1 #
ggplot()+
geom_text(mapping=aes(x=scores[,1],y=scores[,2],label=rownames(scores)),size=5)
scores<-as.data.frame(pcoa$points)
# Computing % of explanation of each axis #
(eigenvals(pcoa)/sum(eigenvals(pcoa)))*100
# Fitting ecomorphological indices to ordination #
efit<-envfit(pcoa,eco, permutations = 999, na.rm = TRUE,choices=c(1:3))
efit2<-as.data.frame(efit$vectors$arrows*sqrt(efit$vectors$r))
efit2<-rbind(efit2,efit$factors$centroids*sqrt(efit$factors$r))
efit
# Plotting Supplementary Figure 1 #
ggplot()+
geom_text(mapping=aes(x=scores[,1],y=scores[,2],label=rownames(scores)),size=5)+
xlab("PC1 (33.21%)")+xlim(c(min(scores[,1])-0.08,max(scores[,1])+0.08))+
ylab("PC2 (26.87%)")+ylim(c(min(scores[,2])-0.08,max(scores[,2])+0.08))+
geom_segment(data=efit2,aes(x=0,xend=efit2[,1]/2.5,y=0,yend=efit2[,2]/2.5),
arrow = arrow(length = unit(0.5, "cm")),colour="blue",
size=0.8,alpha=0.2,inherit.aes=FALSE)+
geom_text(data=efit2,aes(x=(efit2[,1]/2.5),y=(efit2[,2]/2.5+0.015),label=row.names(efit2)),
size=4,color="blue",fontface="bold",alpha=0.5)+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 14),
axis.title = element_text(colour = "black", size = 16, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 12))
# Plotting Supplementary Figure 1 #
fig1<-ggplot()+
geom_text(mapping=aes(x=scores[,1],y=scores[,2],label=rownames(scores)),size=5)+
xlab("PC1 (33.21%)")+xlim(c(min(scores[,1])-0.08,max(scores[,1])+0.08))+
ylab("PC2 (26.87%)")+ylim(c(min(scores[,2])-0.08,max(scores[,2])+0.08))+
geom_segment(data=efit2,aes(x=0,xend=efit2[,1]/2.5,y=0,yend=efit2[,2]/2.5),
arrow = arrow(length = unit(0.5, "cm")),colour="blue",
size=0.8,alpha=0.2,inherit.aes=FALSE)+
geom_text(data=efit2,aes(x=(efit2[,1]/2.5),y=(efit2[,2]/2.5+0.015),label=row.names(efit2)),
size=4,color="blue",fontface="bold",alpha=0.5)+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 14),
axis.title = element_text(colour = "black", size = 16, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 12))
fig2<-ggplot()+
geom_text(mapping=aes(x=scores[,1],y=scores[,3],label=rownames(scores)),size=5)+
xlab("PC1 (33.21%)")+xlim(c(min(scores[,1])-0.08,max(scores[,1])+0.08))+
ylab("PC3 (19.95%)")+ylim(c(min(scores[,3])-0.08,max(scores[,3])+0.08))+
geom_segment(data=efit2,aes(x=0,xend=efit2[,1]/2.5,y=0,yend=efit2[,3]/2.5),
arrow = arrow(length = unit(0.5, "cm")),colour="blue",
size=0.8,alpha=0.2,inherit.aes=FALSE)+
geom_text(data=efit2,aes(x=efit2[,1]/2.5,y=efit2[,3]/2.5+0.02,label=row.names(efit2)),
size=4,color="blue",fontface="bold",alpha=0.5)+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 14),
axis.title = element_text(colour = "black", size = 16, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 12))
fig3<-ggplot()+
geom_text(mapping=aes(x=scores[,2],y=scores[,3],label=rownames(scores)),size=5)+
xlab("PC2 (26.87%)")+xlim(c(min(scores[,2])-0.08,max(scores[,2])+0.08))+
ylab("PC3 (19.95%)")+ylim(c(min(scores[,3])-0.08,max(scores[,3])+0.08))+
geom_segment(data=efit2,aes(x=0,xend=efit2[,2]/2.5,y=0,yend=efit2[,3]/2.5),
arrow = arrow(length = unit(0.5, "cm")),colour="blue",
size=0.8,alpha=0.2,inherit.aes=FALSE)+
geom_text(data=efit2,aes(x=efit2[,2]/2.5+0.015,y=efit2[,3]/2.5+0.015,label=row.names(efit2)),
size=4,color="blue",fontface="bold",alpha=0.5)+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 14),
axis.title = element_text(colour = "black", size = 16, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 12))
sfig1<-grid.arrange(fig1,fig2,fig3,nrow=2)
library(gridExtra)
sfig1<-grid.arrange(fig1,fig2,fig3,nrow=2)
sfig1
ggsave("Supplfig1.png",sfig1,dpi=600,height=18,width=20,units=c("cm"))
dev.off()
# Importing and managing the dataset #
data<-read.table("database.txt",header=T)
# Importing and managing the dataset #
data<-read.table("trawling data.txt",header=T)
comm<-cast(data[,c(1:3)],trawl~species,value='pres',fun.aggregate=mean)
# Opening libraries #
library(reshape2)
# Importing and managing the dataset #
data<-read.table("trawling data.txt",header=T)
comm<-cast(data[,c(1:3)],trawl~species,value='pres',fun.aggregate=mean)
# Opening libraries #
library(reshape2)
comm<-cast(data[,c(1:3)],trawl~species,value='pres',fun.aggregate=mean)
# Opening libraries #
library(reshape)
# Importing and managing the dataset #
data<-read.table("trawling data.txt",header=T)
comm<-cast(data[,c(1:3)],trawl~species,value='pres',fun.aggregate=mean)
comm[is.na(comm)]<-0
row.names(comm)<-comm$trawl
comm<-comm[,-1]
rownames(eco2)
rownames(eco2)
comm
eco<-read.table("ecomorphological data.txt",header=T,row.names=1)
colnames(comm)<-rownames(eco)
comm<-as.data.frame(comm)
comm
library(funrar)
# COmputing Functional distinctiveness sensu Grenié et al. (2017) #
divfunc<-funrar(as.matrix(comm),as.matrix(daisy(eco,metric="gower"))
,rel_abund=FALSE)
# COmputing average Functional distinctiveness sensu Grenié et al. (2017) per plot #
divfunc<-funrar(as.matrix(comm),as.matrix(daisy(eco,metric="gower"))
,rel_abund=FALSE)
distinct<-data.frame(divfunc$Di)
distinct[is.na(distinct)]<-0
avdist<-as.data.frame(apply(distinct,1,function(x) mean(x)))
colnames(avdist)[1]<-"AvDist"
write.table(avdist,file="avDist.txt")
avdist
# Importing the dataset #
abiot<-read.table("trawling data.txt",header=T)
# Renaming species for further plotting #
levels(abiot$NAME_OF_SPECIE)
levels(abiot$NAME_OF_SPECIE)[3]<-"Aru"
levels(abiot$NAME_OF_SPECIE)[6]<-"Ngr"
# Importing the dataset #
abiot<-read.table("trawling data.txt",header=T)
# Renaming species for further plotting #
levels(abiot$NAME_OF_SPECIE)
abiot
# Renaming species for further plotting #
levels(abiot$species)
# Renaming species for further plotting #
levels(abiot$species)[1]<-"Aph"
levels(abiot$species)[2]<-"Aqu"
levels(abiot$species)[3]<-"Aru"
levels(abiot$species)[4]<-"Bba"
levels(abiot$species)[5]<-"Car"
levels(abiot$species)[6]<-"Ngr"
levels(abiot$species)[7]<-"Sco"
levels(abiot$species)[8]<-"Spa"
levels(abiot$species)[9]<-"Spr"
plot(abiot$Prof~abiot$species)
# Plotting Figure 3 #
Depth<-ggplot()+
geom_boxplot(aes(x=abiot$species,y=log(abiot$prof)),
notch=TRUE,fill="grey")+
xlab("Species")+
ylab("Log of Depth (m)")+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 10),
axis.text.x = element_blank(),
axis.title.x=element_blank(),
axis.title = element_text(colour = "black", size = 12, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 16))
library(ggplot2)
library(gridExtra)
# Plotting Figure 3 #
Depth<-ggplot()+
geom_boxplot(aes(x=abiot$species,y=log(abiot$prof)),
notch=TRUE,fill="grey")+
xlab("Species")+
ylab("Log of Depth (m)")+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 10),
axis.text.x = element_blank(),
axis.title.x=element_blank(),
axis.title = element_text(colour = "black", size = 12, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 16))
Salinity<-ggplot()+
geom_boxplot(aes(x=abiot$species,y=abiot$sal),
notch=TRUE,fill="grey")+
ylab("Salinity (?)")+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 10),
axis.text.x = element_blank(),
axis.title.x=element_blank(),
axis.title = element_text(colour = "black", size = 12, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 16))
Temperature<-ggplot()+
geom_boxplot(aes(x=abiot$species,y=abiot$temp),
notch=TRUE,fill="grey")+
xlab("Species")+
ylab("Temperature (ºC)")+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 10),
axis.title = element_text(colour = "black", size = 12, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 16))
figure3<-grid.arrange(Depth,Salinity,Temperature,nrow=3)
ggsave("Figure 3.png",figure2,dpi=600,height=24,width=16,units=c("cm"))
ggsave("Figure 3.png",figure3,dpi=600,height=24,width=16,units=c("cm"))
# Average differences in sites that each species occurred #
anova(lm(log(abiot$prof)~abiot$species))
anova(lm(log(abiot$sal)~abiot$species))
anova(lm(log(abiot$temp)~abiot$species))
trawlings<-read.table("trawling data.txt",header=T)
# Renaming species for further plotting #
levels(trawlings$species)[1]<-"Aph"
levels(trawlings$species)[2]<-"Aqu"
levels(trawlings$species)[3]<-"Aru"
levels(trawlings$species)[4]<-"Bba"
levels(trawlings$species)[5]<-"Car"
levels(trawlings$species)[6]<-"Ngr"
levels(trawlings$species)[7]<-"Sco"
levels(trawlings$species)[8]<-"Spa"
levels(trawlings$species)[9]<-"Spr"
# Average differences in sites that each species occurred #
anova(lm(log(trawlings$prof)~trawlings$species)) # significant p-value
anova(lm(log(trawlings$sal)~trawlings$species)) # significant p-value
anova(lm(log(trawlings$temp)~trawlings$species)) # non-significant p-value
# Plotting Figure 3 #
Depth<-ggplot()+
geom_boxplot(aes(x=trawlings$species,y=log(trawlings$prof)),
notch=TRUE,fill="grey")+
xlab("Species")+
ylab("Log of Depth (m)")+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 10),
axis.text.x = element_blank(),
axis.title.x=element_blank(),
axis.title = element_text(colour = "black", size = 12, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 16))
Salinity<-ggplot()+
geom_boxplot(aes(x=trawlings$species,y=trawlings$sal),
notch=TRUE,fill="grey")+
ylab("Salinity (?)")+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 10),
axis.text.x = element_blank(),
axis.title.x=element_blank(),
axis.title = element_text(colour = "black", size = 12, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 16))
Temperature<-ggplot()+
geom_boxplot(aes(x=trawlings$species,y=trawlings$temp),
notch=TRUE,fill="grey")+
xlab("Species")+
ylab("Temperature (ºC)")+
theme(panel.background = element_rect(fill = "white", colour = "black", size = 0.5), # opcoes graficas
panel.grid.major = element_line(colour = NA),
panel.grid.minor = element_line(colour = NA),
axis.text = element_text(colour = "black", size = 10),
axis.title = element_text(colour = "black", size = 12, face = "bold"),
legend.title = element_blank(),
legend.background = element_rect(fill = "white"),
legend.text = element_text(face = "bold", colour = "black", size = 16))
figure3<-grid.arrange(Depth,Salinity,Temperature,nrow=3)
ggsave("Figure 3.png",figure3,dpi=600,height=24,width=16,units=c("cm"))
cast(trawlings[,c(1:3)],trawl~species,value='pres',fun.aggregate=mean)
library(reshape)
cast(trawlings[,c(1:3)],trawl~species,value='pres',fun.aggregate=mean)
# PCA for environmental variables #
presabs<-cast(trawlings[,c(1:3)],trawl~species,value='pres',fun.aggregate=mean)
abiot
trawlings[,c(1:3)]
# PCA for environmental variables #
env<-aggregate(trawlings[,7:9],list(trawlings$trawl),mean)
row.names(env)<-env$Group.1
colnames(env)[1]<-"plot"
# PCA for environmental variables #
env<-aggregate(trawlings[,7:9],list(trawlings$trawl),mean)
row.names(env)
env$Group.1
# PCA for environmental variables #
env<-aggregate(trawlings[,7:9],list(trawlings$trawl),mean)
row.names(env)<-env$Group.1
# PCA for environmental variables #
env<-aggregate(trawlings[,7:9],list(trawlings$trawl),mean)
env
row.names(env)<-env$Group.1
env<-env[,-1]
env
pc.env<-princomp(decostand(env,method="standardize"),cor=TRUE)
library(vegan)
pc.env<-princomp(decostand(env,method="standardize"),cor=TRUE)
bstick(pc.env) #Broken-stick
eigenvals(pc.env) #just first axis
summary(pc.env)
pc.env$loadings
